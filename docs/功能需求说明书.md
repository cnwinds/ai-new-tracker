# AI News Tracker 功能需求说明书

## 1. 项目概述

### 1.1 项目名称
AI News Tracker（AI新闻追踪系统）

### 1.2 项目定位
自动采集、AI智能分析、RAG检索增强生成、推送全球AI前沿资讯的智能系统

### 1.3 技术架构
- **后端**: FastAPI + SQLAlchemy + SQLite（支持向量存储）
- **前端**: React 18 + TypeScript + Ant Design 5 + Vite
- **AI服务**: 支持OpenAI API及兼容格式的第三方API
- **实时通信**: WebSocket
- **任务调度**: APScheduler

---

## 2. 核心功能模块

### 2.1 数据采集模块

#### 2.1.1 多源数据采集
系统支持从多种数据源采集文章：

**RSS订阅采集**
- 支持标准RSS/Atom格式订阅源
- 自动解析文章标题、内容、发布时间、作者等信息
- 支持自定义采集优先级和最大文章数限制
- 支持启用/禁用单个订阅源

**API接口采集**
- **arXiv采集**: 支持从arXiv API采集论文（cs.AI, cs.LG, cs.CL, cs.CV等分类）
- **Hugging Face采集**: 采集Hugging Face平台的论文和模型信息
- **Papers with Code采集**: 采集论文和代码实现信息

**网页爬虫采集**
- 支持从任意网页URL采集文章内容
- 智能解析文章正文（去除导航、广告等无关内容）
- 支持自定义CSS选择器配置
- 支持AI自动修复解析配置

**Twitter采集**
- 支持从Twitter/X平台采集推文
- 可配置关键词、用户、话题等筛选条件

**邮件采集**
- 支持从邮件系统采集文章内容
- 自动解析邮件正文和附件

**手动URL采集**
- 用户可通过Web界面输入URL手动采集单篇文章
- 采集后自动进行AI分析

#### 2.1.2 智能去重机制
- 基于URL的唯一性检查，避免重复采集
- 基于标题相似度的去重（可选）
- 自动跳过已存在的文章

#### 2.1.3 采集任务管理
- **手动触发采集**: 用户可通过Web界面手动启动采集任务
- **自动定时采集**: 支持配置定时采集任务（可设置采集频率）
- **采集任务状态**: 实时显示采集进度、成功/失败统计
- **采集历史记录**: 保存每次采集任务的详细信息
- **任务停止功能**: 支持手动停止正在运行的采集任务
- **任务恢复机制**: 自动检测并恢复挂起的采集任务

#### 2.1.4 实时进度推送
- 通过WebSocket实时推送采集进度
- 显示当前采集的源、已采集文章数、预计完成时间
- 采集完成/失败时自动通知

#### 2.1.5 订阅源管理
- **订阅源列表**: 查看所有已配置的订阅源
- **订阅源分类**: 支持按类型（RSS/API/Web/Social/Email）、分类（corporate_lab/academic/individual/newsletter）、梯队（tier1/tier2/tier3）筛选
- **订阅源编辑**: 支持添加、编辑、删除订阅源
- **批量导入**: 支持从默认配置批量导入订阅源
- **启用/禁用**: 可单独启用或禁用某个订阅源
- **优先级设置**: 支持设置采集优先级（1-5，数字越小优先级越高）
- **自定义配置**: 支持为每个源配置自定义参数（如CSS选择器、解析规则等）
- **AI修复功能**: 当源解析失败时，可使用AI自动修复解析配置
- **修复历史**: 记录每次AI修复的配置变更历史

---

### 2.2 AI智能分析模块

#### 2.2.1 自动摘要生成
- 使用大语言模型自动生成文章摘要
- 支持中英文摘要
- 摘要内容简洁明了，突出文章核心观点

#### 2.2.2 关键信息提取
- **关键点提取**: 自动提取文章的3-5个关键信息点
- **标签生成**: 自动为文章打上相关标签（如：机器学习、深度学习、NLP等）
- **主题识别**: 识别文章所属的主题领域
- **相关论文**: 识别文章中提到的相关论文

#### 2.2.3 重要性评分
- AI评估文章重要性，分为三个等级：
  - **高重要性**: 突破性进展、重大发现、重要产品发布等
  - **中重要性**: 一般性研究进展、产品更新等
  - **低重要性**: 常规更新、小功能改进等
- 支持"未分析"状态，用于标记尚未进行AI分析的文章

#### 2.2.4 目标受众识别
- 自动识别文章的目标受众：
  - **researcher**: 研究人员
  - **engineer**: 工程师
  - **general**: 普通读者

#### 2.2.5 中文标题翻译
- 自动将英文标题翻译为中文（如果AI分析返回了中文标题）

#### 2.2.6 自定义分析提示词
- 支持为每个订阅源配置自定义AI分析提示词
- 可根据不同源的特点定制分析要求

#### 2.2.7 重新分析功能
- 支持对已分析的文章进行重新分析
- 可强制重新分析（即使已分析过）

---

### 2.3 RAG检索增强生成模块

#### 2.3.1 向量索引
- **自动索引**: 文章采集和分析后自动创建向量索引
- **批量索引**: 支持批量索引历史文章
- **索引重建**: 支持清空并重建所有索引
- **索引统计**: 显示已索引文章数、索引状态等统计信息

#### 2.3.2 语义搜索
- **向量相似度搜索**: 基于文章内容的向量表示进行语义搜索
- **多条件筛选**: 支持按来源、重要性、时间范围等条件筛选
- **相关性排序**: 搜索结果按相关性从高到低排序
- **搜索关键词高亮**: 在搜索结果中高亮显示匹配的关键词

#### 2.3.3 智能问答
- **基于文章内容的问答**: 基于检索到的相关文章内容回答问题
- **对话历史支持**: 支持多轮对话，保持上下文连贯性
- **流式输出**: 支持流式输出答案，提升用户体验
- **答案来源标注**: 显示答案引用的文章来源
- **相关文章推荐**: 在回答后推荐相关文章

#### 2.3.4 索引管理
- **单篇文章索引**: 支持手动索引单篇文章
- **批量索引**: 支持批量索引未索引的文章
- **索引清空**: 支持清空所有索引
- **索引重建**: 支持强制重建所有索引

---

### 2.4 Web Dashboard模块

#### 2.4.1 文章列表
- **文章展示**: 以卡片形式展示文章列表
- **分页显示**: 支持分页浏览，可自定义每页显示数量
- **时间筛选**: 支持按时间范围筛选（今天、最近3天、最近7天、最近30天、全部）
- **来源筛选**: 支持按来源筛选，支持正向筛选（包含）和反向筛选（排除）
- **重要性筛选**: 支持按重要性筛选（高/中/低/未分析）
- **分类筛选**: 支持按分类筛选
- **实时刷新**: 支持手动刷新文章列表
- **按需加载**: 默认只加载基本字段，详细信息按需加载以节省网络流量

#### 2.4.2 文章详情
- **文章查看**: 点击文章卡片查看完整详情
- **字段按需加载**: 支持按需加载特定字段（摘要、内容、标签、作者、用户笔记等）
- **文章操作**:
  - 收藏/取消收藏
  - 添加/编辑用户笔记
  - 重新进行AI分析
  - 删除文章
  - 打开原文链接

#### 2.4.3 文章收藏
- 支持收藏感兴趣的文章
- 可查看所有收藏的文章
- 收藏状态持久化保存

#### 2.4.4 用户笔记
- 支持为每篇文章添加用户笔记
- 笔记内容可随时编辑和删除
- 笔记用于记录用户当时的思考或评论

#### 2.4.5 采集任务管理
- **启动采集**: 手动触发采集任务，可选择是否启用AI分析
- **采集状态**: 实时显示当前采集任务的状态（运行中/已完成/失败）
- **采集历史**: 查看历史采集任务列表
- **任务详情**: 查看每个任务的详细信息：
  - 任务状态、耗时、新增文章数
  - 成功/失败的源列表
  - 采集日志
  - 新增文章列表
- **停止任务**: 支持手动停止正在运行的采集任务
- **任务恢复**: 支持手动恢复挂起的采集任务

#### 2.4.6 每日/每周摘要
- **摘要列表**: 查看历史生成的每日/每周摘要
- **摘要详情**: 查看摘要的完整内容，包括：
  - 总结内容
  - 关键主题
  - 推荐文章列表（含推荐理由）
  - 统计信息（文章总数、高/中重要性文章数等）
- **生成摘要**: 支持手动生成指定日期/周的摘要
- **删除摘要**: 支持删除不需要的摘要

#### 2.4.7 数据统计
- **基础统计**:
  - 文章总数
  - 今日新增文章数
  - 高/中/低重要性文章数
  - 未分析文章数
- **来源分布**: 可视化展示各来源的文章数量分布
- **分类分布**: 可视化展示各分类的文章数量分布
- **重要性分布**: 可视化展示各重要性等级的文章数量分布

#### 2.4.8 订阅源管理
- **源列表**: 查看所有已配置的订阅源
- **源筛选**: 支持按类型、分类、梯队、启用状态筛选
- **源操作**:
  - 添加新源
  - 编辑源信息
  - 删除源
  - 启用/禁用源
  - 批量导入默认源
- **源详情**: 查看源的详细信息，包括：
  - 基本信息（名称、URL、描述等）
  - 配置信息（分类、梯队、优先级等）
  - 统计信息（采集文章数、最后采集时间、最新文章发布时间等）
  - 错误信息（最后错误信息）
  - 修复历史（AI修复配置的历史记录）
- **AI修复**: 当源解析失败时，可使用AI自动修复解析配置

#### 2.4.9 系统设置
- **采集设置**:
  - 文章最大保留天数
  - AI分析最大保留天数
- **自动采集设置**:
  - 启用/禁用自动采集
  - 采集频率（小时）
  - 每源最大文章数
  - 请求超时时间
- **摘要设置**:
  - 启用/禁用每日摘要
  - 每日摘要生成时间
  - 启用/禁用每周摘要
  - 每周摘要生成时间
- **LLM设置**:
  - 选择LLM提供商（支持多个提供商）
  - 选择向量模型提供商
  - 选择LLM模型（支持多个模型）
  - 选择向量模型（支持多个模型）
- **LLM提供商管理**:
  - 添加/编辑/删除LLM提供商
  - 配置提供商信息（名称、API密钥、API地址、模型列表等）
  - 启用/禁用提供商
- **通知设置**:
  - 选择通知平台（飞书/钉钉）
  - 配置Webhook URL
  - 配置加签密钥（钉钉可选）
  - 启用/禁用即时通知（高重要性文章）
  - 配置勿扰时段

#### 2.4.10 RAG功能界面
- **语义搜索**:
  - 搜索框输入关键词
  - 筛选条件（来源、重要性、时间范围）
  - 搜索结果列表
  - 相关性评分显示
- **智能问答**:
  - 问题输入框
  - 对话历史显示
  - 流式答案输出
  - 答案来源文章列表
  - 相关文章推荐
- **索引管理**:
  - 索引统计信息
  - 批量索引操作
  - 索引重建操作
  - 索引清空操作

#### 2.4.11 数据清理
- **自动清理**: 支持配置自动清理过期数据
- **手动清理**: 支持手动清理指定时间范围的数据
- **清理统计**: 显示清理的数据量

#### 2.4.12 用户认证
- **登录功能**: 支持用户登录（用于保护敏感操作）
- **登出功能**: 支持用户登出
- **权限控制**: 未登录用户只能查看，登录用户可进行修改操作

#### 2.4.13 主题切换
- **深色/浅色主题**: 支持切换深色和浅色主题
- **主题持久化**: 主题选择持久化保存

#### 2.4.14 实时更新
- **WebSocket连接**: 通过WebSocket实时接收服务器推送的更新
- **采集进度推送**: 实时显示采集进度
- **新文章通知**: 新文章采集完成时自动通知

---

### 2.5 前端界面设计

#### 2.5.1 整体布局设计
- **响应式布局**: 采用Ant Design Layout组件，支持桌面端和移动端自适应
- **导航栏设计**:
  - 顶部固定导航栏，深色背景（#001529），白色文字
  - 左侧显示Logo和系统名称（AI News Tracker）
  - 中间为全局搜索框（支持快捷键 Cmd/Ctrl + K）
  - 右侧显示主题切换按钮、设置按钮、用户信息
  - 移动端自动适配，Logo和文字大小自适应
- **内容区域**: 主内容区采用卡片式布局，支持Tab切换不同功能模块
- **侧边抽屉**: 系统设置采用右侧抽屉（Drawer）形式，宽度800px，支持滚动

#### 2.5.2 主题系统
- **双主题支持**: 
  - 浅色主题：白色背景，深色文字，适合日间使用
  - 深色主题：深色背景（#1a1a1a），浅色文字，适合夜间使用
- **主题变量系统**: 使用CSS变量统一管理颜色，包括：
  - 背景色（base/container/elevated/secondary）
  - 文字色（text/text-secondary/text-tertiary）
  - 边框色（border/border-secondary）
  - 主题色（primary/success/warning/error）
- **主题切换**: 一键切换，选择持久化保存到localStorage
- **主题一致性**: 所有组件（卡片、按钮、输入框、表格、模态框等）统一适配主题

#### 2.5.3 全局搜索设计
- **智能搜索框**:
  - 位置：导航栏中央，最大宽度800px
  - 功能：支持搜索新闻、AI问答、URL采集
  - 快捷键：Cmd/Ctrl + K 快速聚焦
  - 占位符提示："搜索新闻，或向 AI 提问，或输入文章URL (Cmd+K)"
- **智能下拉面板（SmartDropdown）**:
  - **零态（无输入）**: 显示搜索历史、AI对话历史、快速操作
  - **输入态**: 智能识别用户意图
    - URL格式：显示"采集文章"选项
    - 问题格式：显示"AI问答"选项
    - 关键词：显示"搜索文章"选项
  - **实时搜索**: 输入时实时显示匹配的文章列表
  - **历史记录**: 保存最近10条搜索历史，支持快速选择
  - **索引提示**: 显示RAG索引统计，未索引文章时提示建立索引

#### 2.5.4 文章卡片设计
- **卡片布局**:
  - 紧凑型设计，默认折叠状态
  - 第一行：日期Tag + 重要性Tag + 标题 + 来源Tag + 收藏标记 + 展开/收起按钮
  - 整行可点击展开（除来源Tag外）
  - 标题支持中文标题显示，鼠标悬停显示英文原标题
- **展开状态**:
  - 元信息：发布时间、作者、分析状态
  - AI摘要：Markdown格式渲染，带"AI生成的精简摘要"标签
  - 文章内容：默认折叠，可展开查看完整内容
  - 标签区域：横向排列，支持换行
  - 用户笔记：可编辑文本框，支持保存
  - 操作按钮组：
    - 第一组：查看原文、分享、收藏
    - 第二组：笔记编辑
    - 第三组：AI分析、删除、收起
- **交互设计**:
  - 标题悬停变色（主题色）
  - 来源Tag可点击跳转原文
  - 按需加载：展开时才加载详细字段，节省网络流量
  - 加载状态：显示Spin加载动画

#### 2.5.5 文章详情模态框
- **全屏模态框**:
  - 桌面端：最大宽度900px，居中显示
  - 移动端：全屏显示，适配小屏幕
  - 背景模糊效果（backdrop-filter: blur(10px)）
- **顶部栏**:
  - 固定顶部（sticky），显示重要性Tag、标题、来源Tag
  - 右侧关闭按钮（支持Esc键关闭）
- **内容区域**:
  - 元信息：发布时间、作者
  - AI摘要：卡片式展示，Markdown渲染
  - 文章内容：可折叠展开，Markdown渲染
  - 标签：横向排列
  - 操作按钮：查看原文、分享链接、收藏
- **响应式设计**: 根据屏幕宽度自动调整字体大小和布局

#### 2.5.6 文章列表页面
- **筛选栏**:
  - 时间范围选择：今天、最近3天、最近7天、最近30天、全部
  - 来源筛选：支持正向筛选（包含）和反向筛选（排除）
  - 重要性筛选：高/中/低/未分析
  - 分类筛选：按文章分类筛选
  - 筛选模式切换：正向/反向筛选切换按钮
- **列表展示**:
  - 卡片式布局，每篇文章一个卡片
  - 分页显示，默认每页20条，可自定义
  - 实时刷新按钮
  - 显示文章总数和当前筛选结果
- **空状态**: 无数据时显示友好的空状态提示

#### 2.5.7 数据统计页面
- **统计卡片**:
  - 4个统计卡片横向排列：总文章数、今日新增、高重要性、待分析
  - 使用Ant Design Statistic组件，数字突出显示
  - 高重要性使用红色高亮
- **图表展示**:
  - 来源分布：柱状图，显示前10个来源
  - 重要性分布：柱状图，不同重要性使用不同颜色
  - 使用Recharts库，响应式设计
  - 图表支持Tooltip交互

#### 2.5.8 每日/每周摘要页面
- **摘要列表**:
  - 列表形式展示历史摘要
  - 每个摘要项显示：类型（每日/每周）、日期、统计信息
  - 支持展开查看详细内容
- **摘要详情**:
  - 摘要内容：Markdown格式渲染
  - 关键主题：标签形式展示
  - 推荐文章：列表形式，显示推荐理由
  - 统计信息：文章总数、高/中重要性文章数
- **生成摘要**:
  - 模态框表单，选择摘要类型（每日/每周）
  - 日期选择器：支持选择指定日期或周
  - 周选择：可视化日历，高亮显示选中周的范围
- **操作按钮**: 生成、重新生成、删除摘要

#### 2.5.9 RAG功能界面
- **统计信息卡片**:
  - 4个统计指标：总文章数、已索引、未索引、索引覆盖率
  - 未索引文章时显示提示和批量索引按钮
- **语义搜索Tab**:
  - 搜索框：支持关键词输入
  - 筛选条件：
    - 来源筛选：多选下拉框，按类型分组
    - 重要性筛选：多选下拉框
    - 时间范围：日期范围选择器
  - 返回数量选择：5/10/20/50
  - 搜索结果：
    - 列表形式展示
    - 显示相关性评分（百分比）
    - 显示文章标题、摘要、来源、重要性、发布时间
    - 支持点击查看详情
- **AI对话Tab**:
  - 对话历史侧边栏：显示历史对话列表，支持新建、删除对话
  - 消息列表：
    - 用户消息：右侧显示，蓝色气泡
    - AI消息：左侧显示，灰色气泡，带机器人图标
    - 流式输出：支持实时显示AI回答
    - Markdown渲染：支持代码高亮、链接等
  - 输入区域：
    - 多行文本输入框
    - 发送按钮
    - Top-K选择器（检索文章数量）
  - 答案来源：
    - 显示引用的文章列表
    - 显示相关性评分
    - 支持点击查看文章详情
  - 相关文章推荐：在回答后显示相关文章列表

#### 2.5.10 系统设置界面
- **Tab布局**:
  - 多个Tab页：采集设置、自动采集、摘要设置、LLM设置、LLM提供商、通知设置、订阅源管理、数据清理、采集历史
- **表单设计**:
  - 使用Ant Design Form组件
  - 表单验证和错误提示
  - 保存按钮，显示保存状态
- **LLM提供商管理**:
  - 表格形式展示提供商列表
  - 支持添加、编辑、删除提供商
  - 模态框表单编辑
  - 未登录用户不显示API密钥
- **通知设置**:
  - 平台选择：飞书/钉钉单选
  - Webhook URL输入
  - 加签密钥输入（钉钉）
  - 勿扰时段：动态添加/删除时间段
- **订阅源管理**:
  - 表格展示，支持筛选和排序
  - 批量导入功能
  - 编辑表单支持所有配置项
  - AI修复功能入口

#### 2.5.11 采集任务管理界面
- **任务列表**:
  - 表格形式展示历史任务
  - 显示：任务ID、状态、开始时间、完成时间、新增文章数、耗时
  - 状态标签：运行中（蓝色）、已完成（绿色）、失败（红色）
- **任务详情**:
  - 模态框或抽屉展示
  - 标签页：成功源、失败源、新增文章
  - 日志列表：显示每个源的采集情况
  - 文章列表：显示本次采集的新文章

#### 2.5.12 响应式设计
- **断点设计**:
  - 移动端：< 768px
  - 平板端：768px - 1024px
  - 桌面端：> 1024px
- **移动端适配**:
  - 导航栏：Logo和文字缩小，按钮图标化
  - 搜索框：全宽显示
  - 卡片：去除边距，全宽显示
  - 表格：横向滚动或卡片化
  - 模态框：全屏显示
- **交互优化**:
  - 触摸友好的按钮大小（最小44x44px）
  - 手势支持（滑动、点击）
  - 键盘导航支持

#### 2.5.13 动画和过渡效果
- **主题切换**: 平滑的颜色过渡动画（0.3s ease）
- **展开/收起**: 平滑的高度变化
- **加载状态**: Spin旋转动画
- **流式输出**: 打字机效果，光标闪烁动画
- **悬停效果**: 按钮、链接的颜色变化
- **模态框**: 淡入淡出动画

#### 2.5.14 可访问性设计
- **键盘导航**: 
  - Tab键切换焦点
  - Enter键确认
  - Esc键关闭模态框
  - Cmd/Ctrl + K 聚焦搜索框
- **语义化HTML**: 使用正确的HTML标签
- **ARIA标签**: 为屏幕阅读器提供支持
- **颜色对比度**: 符合WCAG AA标准
- **焦点指示**: 清晰的焦点边框

#### 2.5.15 性能优化
- **按需加载**: 文章详细字段只在展开时加载
- **虚拟滚动**: 长列表使用虚拟滚动（未来优化）
- **图片懒加载**: 图片按需加载
- **代码分割**: 路由级别的代码分割
- **缓存策略**: React Query缓存，减少重复请求

---

### 2.6 通知推送模块

#### 2.6.1 通知平台支持
- **飞书机器人**: 支持通过飞书Webhook推送通知
- **钉钉机器人**: 支持通过钉钉Webhook推送通知（支持加签安全设置）

#### 2.6.2 推送类型
- **每日摘要推送**: 每日摘要生成完成后自动推送
- **每周摘要推送**: 每周摘要生成完成后自动推送
- **高重要性文章即时推送**: 采集到高重要性文章时即时推送（如果启用了即时通知）

#### 2.6.3 推送内容
- **摘要推送**: 包含摘要内容、关键主题、推荐文章列表
- **即时推送**: 包含文章标题、摘要、重要性、原文链接

#### 2.6.4 推送控制
- **勿扰时段**: 支持配置勿扰时段，在指定时间段内不发送通知
- **推送开关**: 可单独控制各类推送的启用/禁用

#### 2.6.5 推送历史
- 记录所有推送历史
- 显示推送状态（成功/失败）、推送时间、推送内容摘要

---

### 2.7 定时调度模块

#### 2.7.1 自动采集任务
- **定时采集**: 根据配置的采集频率自动执行采集任务
- **任务调度**: 使用APScheduler进行任务调度
- **任务状态**: 实时监控任务执行状态

#### 2.7.2 自动摘要生成
- **每日摘要**: 在配置的时间自动生成每日摘要
- **每周摘要**: 在配置的时间自动生成每周摘要
- **Cron表达式**: 支持使用Cron表达式配置执行时间

#### 2.7.3 调度器管理
- **自动启动**: 应用启动时自动启动调度器（如果启用了自动采集）
- **任务更新**: 配置变更时自动更新调度任务
- **任务查看**: 查看已注册的定时任务及其下次执行时间

---

### 2.8 数据管理模块

#### 2.8.1 数据清理
- **过期数据清理**: 自动清理超过保留期限的文章
- **未分析数据清理**: 支持清理长期未分析的文章
- **清理策略**: 可配置清理规则和保留期限

#### 2.8.2 数据统计
- **采集统计**: 统计各源的采集情况
- **文章统计**: 统计文章的数量、分布、重要性等
- **时间统计**: 按时间维度统计文章数量

#### 2.8.3 数据导出
- **文章导出**: 支持导出文章数据（未来功能）
- **统计报告**: 支持导出统计报告（未来功能）

---

## 3. 非功能性需求

### 3.1 性能需求
- **响应时间**: API接口响应时间应小于1秒（正常情况）
- **并发处理**: 支持多源并发采集，提升采集效率
- **数据库优化**: 使用复合索引优化常用查询
- **按需加载**: 前端采用按需加载策略，减少网络流量

### 3.2 可靠性需求
- **错误处理**: 完善的错误处理和异常捕获机制
- **任务恢复**: 自动检测并恢复挂起的采集任务
- **数据一致性**: 确保数据的一致性和完整性
- **日志记录**: 详细的日志记录，便于问题排查

### 3.3 安全性需求
- **用户认证**: 敏感操作需要用户登录
- **API密钥保护**: API密钥存储在数据库中，未登录用户无法查看
- **CORS配置**: 支持配置CORS策略
- **输入验证**: 完善的输入验证和参数校验

### 3.4 可维护性需求
- **模块化设计**: 采用模块化架构，便于维护和扩展
- **代码规范**: 遵循Python和TypeScript代码规范
- **文档完善**: 提供完善的代码注释和API文档
- **配置管理**: 统一的配置管理机制

### 3.5 可扩展性需求
- **多LLM支持**: 支持配置多个LLM提供商
- **多模型支持**: 支持为每个提供商配置多个模型
- **插件化架构**: 采集器采用插件化设计，便于添加新的数据源
- **API扩展**: RESTful API设计，便于功能扩展

### 3.6 用户体验需求
- **界面友好**: 现代化、美观的Web界面
- **响应式设计**: 支持不同屏幕尺寸
- **实时反馈**: 通过WebSocket实时推送状态更新
- **操作便捷**: 常用功能一键操作，减少用户操作步骤

---

## 4. 数据模型

### 4.1 文章表（articles）
- 基本信息：标题、URL、内容、来源、作者、发布时间等
- AI分析结果：摘要、关键点、标签、重要性、目标受众等
- 元数据：是否已分析、是否已推送、是否已收藏、用户笔记等
- 时间戳：创建时间、更新时间、采集时间

### 4.2 订阅源表（rss_sources）
- 基本信息：名称、URL、描述、分类、梯队等
- 配置信息：源类型、语言、优先级、启用状态等
- 扩展配置：自定义配置（JSON格式）
- 统计信息：采集文章数、最后采集时间、最新文章发布时间等
- 错误信息：最后错误信息
- 修复历史：AI修复配置的历史记录（JSON格式）

### 4.3 采集任务表（collection_tasks）
- 任务信息：状态、开始时间、完成时间、耗时等
- 统计信息：新增文章数、总源数、成功/失败源数等
- AI分析信息：是否启用AI分析、AI分析文章数

### 4.4 采集日志表（collection_logs）
- 日志信息：源名称、源类型、状态、文章数等
- 错误信息：错误消息
- 时间信息：开始时间、完成时间
- 关联信息：关联的任务ID

### 4.5 每日摘要表（daily_summaries）
- 摘要信息：摘要类型（每日/每周）、摘要日期、时间范围等
- 统计信息：文章总数、高/中重要性文章数
- 内容信息：摘要内容、关键主题、推荐文章列表
- 元数据：使用的模型、生成耗时

### 4.6 推送日志表（notification_logs）
- 推送信息：推送类型、平台、状态、文章数等
- 错误信息：错误消息
- 时间信息：推送时间

### 4.7 文章向量表（article_embeddings）
- 向量信息：文章ID、嵌入向量、文本内容、嵌入模型
- 时间戳：创建时间、更新时间

### 4.8 应用配置表（app_settings）
- 配置信息：配置键、配置值、值类型、描述等
- 时间戳：创建时间、更新时间

### 4.9 LLM提供商表（llm_providers）
- 提供商信息：名称、API密钥、API地址、模型列表等
- 状态信息：启用/禁用状态
- 时间戳：创建时间、更新时间

---

## 5. API接口

### 5.1 文章相关接口
- `GET /api/v1/articles` - 获取文章列表（支持筛选和分页）
- `GET /api/v1/articles/{id}` - 获取文章详情
- `GET /api/v1/articles/{id}/fields` - 获取文章的特定字段
- `POST /api/v1/articles/{id}/analyze` - 触发文章AI分析
- `DELETE /api/v1/articles/{id}` - 删除文章
- `POST /api/v1/articles/{id}/favorite` - 收藏文章
- `DELETE /api/v1/articles/{id}/favorite` - 取消收藏
- `PUT /api/v1/articles/{id}` - 更新文章
- `POST /api/v1/articles/collect` - 从URL手动采集文章

### 5.2 采集相关接口
- `POST /api/v1/collection/start` - 启动采集任务
- `GET /api/v1/collection/tasks` - 获取采集历史
- `GET /api/v1/collection/tasks/{id}` - 获取采集任务详情
- `GET /api/v1/collection/tasks/{id}/detail` - 获取采集任务详细信息
- `GET /api/v1/collection/status` - 获取当前采集状态
- `POST /api/v1/collection/stop` - 停止采集任务
- `POST /api/v1/collection/tasks/recover-stuck` - 恢复挂起的任务

### 5.3 摘要相关接口
- `GET /api/v1/summary` - 获取历史摘要列表
- `GET /api/v1/summary/{id}` - 获取摘要详情
- `POST /api/v1/summary/generate` - 生成新摘要
- `DELETE /api/v1/summary/{id}` - 删除摘要

### 5.4 订阅源相关接口
- `GET /api/v1/sources` - 获取订阅源列表
- `GET /api/v1/sources/{id}` - 获取订阅源详情
- `POST /api/v1/sources` - 创建订阅源
- `PUT /api/v1/sources/{id}` - 更新订阅源
- `DELETE /api/v1/sources/{id}` - 删除订阅源
- `GET /api/v1/sources/default/list` - 获取默认数据源列表
- `POST /api/v1/sources/default/import` - 批量导入默认数据源
- `POST /api/v1/sources/{id}/fix-parse` - AI修复解析配置
- `GET /api/v1/sources/{id}/fix-history` - 获取修复历史

### 5.5 统计相关接口
- `GET /api/v1/statistics` - 获取统计数据

### 5.6 RAG相关接口
- `POST /api/v1/rag/search` - 语义搜索文章
- `POST /api/v1/rag/query` - 智能问答
- `POST /api/v1/rag/query/stream` - 智能问答（流式）
- `POST /api/v1/rag/index/batch` - 批量索引文章
- `POST /api/v1/rag/index/all` - 索引所有未索引的文章
- `POST /api/v1/rag/index/{id}` - 索引单篇文章
- `POST /api/v1/rag/index/clear` - 清空所有索引
- `POST /api/v1/rag/index/rebuild` - 强制重建所有索引
- `GET /api/v1/rag/stats` - 获取RAG索引统计信息

### 5.7 设置相关接口
- `GET /api/v1/settings/collection` - 获取采集配置
- `PUT /api/v1/settings/collection` - 更新采集配置
- `GET /api/v1/settings/auto-collection` - 获取自动采集配置
- `PUT /api/v1/settings/auto-collection` - 更新自动采集配置
- `GET /api/v1/settings/summary` - 获取摘要配置
- `PUT /api/v1/settings/summary` - 更新摘要配置
- `GET /api/v1/settings/llm` - 获取LLM配置
- `PUT /api/v1/settings/llm` - 更新LLM配置
- `GET /api/v1/settings/providers` - 获取LLM提供商列表
- `POST /api/v1/settings/providers` - 创建LLM提供商
- `GET /api/v1/settings/providers/{id}` - 获取LLM提供商详情
- `PUT /api/v1/settings/providers/{id}` - 更新LLM提供商
- `DELETE /api/v1/settings/providers/{id}` - 删除LLM提供商
- `GET /api/v1/settings/collector` - 获取采集器配置
- `PUT /api/v1/settings/collector` - 更新采集器配置
- `GET /api/v1/settings/notification` - 获取通知配置
- `PUT /api/v1/settings/notification` - 更新通知配置

### 5.8 清理相关接口
- `POST /api/v1/cleanup` - 执行数据清理

### 5.9 WebSocket接口
- `WS /api/v1/ws` - WebSocket连接，用于实时推送采集进度和状态更新

---

## 6. 部署和运维

### 6.1 部署方式
- **Docker部署**: 提供完整的Docker Compose配置，支持一键部署
- **手动部署**: 支持手动安装和配置

### 6.2 环境要求
- **后端**: Python 3.9+
- **前端**: Node.js 16+
- **数据库**: SQLite（内置，支持向量存储）

### 6.3 配置管理
- **环境变量**: 支持通过环境变量配置基础设置
- **数据库配置**: 系统设置存储在数据库中，通过Web界面管理
- **配置文件**: 数据源配置通过JSON文件管理

### 6.4 日志管理
- **日志级别**: 支持配置日志级别
- **日志文件**: 日志输出到文件
- **日志格式**: 结构化的日志格式，便于分析

---

## 7. 未来规划

### 7.1 计划中的功能
- [ ] 支持更多数据源（YouTube、Podcast等）
- [ ] 用户个性化推荐
- [ ] 数据导出功能（PDF、邮件）
- [ ] 多语言支持
- [ ] 移动端适配

### 7.2 性能优化
- [ ] 数据库查询优化
- [ ] 缓存机制
- [ ] 批量处理优化

### 7.3 功能增强
- [ ] 更丰富的统计分析
- [ ] 更智能的推荐算法
- [ ] 更强大的搜索功能

---

## 8. 附录

### 8.1 术语表
- **RAG**: Retrieval-Augmented Generation，检索增强生成
- **LLM**: Large Language Model，大语言模型
- **WebSocket**: 一种网络通信协议，支持全双工通信
- **Cron表达式**: 用于配置定时任务的表达式

### 8.2 参考文档
- FastAPI官方文档
- React官方文档
- Ant Design官方文档
- SQLAlchemy官方文档

---

**文档版本**: 1.0  
**最后更新**: 2024年  
**维护者**: AI News Tracker开发团队
